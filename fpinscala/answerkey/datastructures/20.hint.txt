You should be able to use a combination of existing functions.