Try to avoid using explicit recursion. Use `zipAll` and `takeWhile`.